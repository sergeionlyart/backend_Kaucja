# OpenAI Codex — заметки для команды проекта

Этот файл — практичная памятка «как работать с Codex на этом репозитории».

## 1) Что такое Codex (в контексте разработки)
Codex — агент для разработки, который умеет:
- читать/править файлы,
- запускать команды (тесты/линт/сборку),
- вести несколько потоков работы параллельно (multi-agent / worktrees),
- делать ревью диффов.

## 2) Как Codex принимает инструкции
### 2.1 AGENTS.md
- Codex читает `AGENTS.md` перед началом работы.
- Инструкции могут быть глобальными (`~/.codex/AGENTS.md`) и проектными (внутри репозитория).
- Инструкции собираются цепочкой от корня проекта к текущей директории; более «близкие» файлы перекрывают более общие.

На этом проекте основной файл: `AGENTS.md` (в корне).

### 2.2 Skills
Codex поддерживает «skills» — пакеты инструкций/ресурсов, которые можно вызывать явно.

В этом репозитории skills лежат в `.agents/skills/*/SKILL.md`.

Рекомендация: если задача типовая (валидация схемы, сохранение артефактов, нормализация usage и т.п.) — сначала попробуйте найти/вызвать подходящий skill.

## 3) Параллельная работа
### 3.1 Worktrees
Для параллельной работы без конфликтов используйте Git worktrees:
- один worktree = одна задача/ветка,
- изменения из worktree переносим в PR.

См. `docs/DEV_WORKFLOW.md`.

### 3.2 Multi-agent
Когда orchestrator просит несколько агентов, каждый должен:
- иметь чётко ограниченный scope,
- возвращать отчёт по шаблону (см. `AGENTS.md`),
- не редактировать чужие модули.

## 4) Ревью
В CLI есть режим локального ревью (без изменения рабочей директории).

Рекомендация для PR:
- запускать ревью с фокусом на security / data-loss / schema correctness,
- фиксировать найденные issues до merge.

## 5) Security-позиция для этого проекта
Особенность домена: документы (PDF/DOC/DOCX) потенциально содержат PII и могут включать prompt-injection.

Поэтому:
- внутри продукта LLM вызываем **без tools** и только по OCR→Markdown.
- логи не должны содержать PII.

